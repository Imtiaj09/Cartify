<section class="home-page">
  <div class="container-fluid px-3 px-lg-4">
    <!-- Hero Banner -->
    <section class="hero-banner position-relative overflow-hidden rounded-4 mt-4 section-spacer">
      <div id="heroPromoCarousel" class="carousel slide h-100" data-bs-ride="carousel" data-bs-interval="5500">
        <div class="carousel-inner h-100">
          <div class="carousel-item h-100" *ngFor="let slide of heroSlides; let i = index" [class.active]="i === 0">
            <article class="hero-slide h-100 p-4 p-md-5">
              <div class="row g-4 align-items-center h-100">
                <div class="col-12 col-lg-7">
                  <div class="hero-content">
                    <p class="text-white-50 mb-2 text-uppercase small fw-semibold">{{ slide.eyebrow }}</p>
                    <h2 class="hero-title text-white fw-bold fst-italic mb-3">{{ slide.title }}</h2>
                    <p class="hero-subtitle mb-4">{{ slide.subtitle }}</p>
                    <a [attr.href]="slide.ctaLink" class="btn btn-light btn-lg rounded-pill px-4 fw-semibold text-success">{{ slide.ctaText }}</a>
                  </div>
                </div>
                <div class="col-12 col-lg-5">
                  <div class="hero-media mx-auto mx-lg-0 ms-lg-auto">
                    <img class="hero-image img-fluid" [src]="slide.imageUrl" [alt]="slide.imageAlt" loading="lazy" />
                  </div>
                </div>
              </div>
            </article>
          </div>
        </div>

        <button class="carousel-control-prev slider-arrow slider-arrow-left hero-control" type="button" data-bs-target="#heroPromoCarousel" data-bs-slide="prev">
          <span class="slider-arrow-icon" aria-hidden="true">
            <i class="bi bi-chevron-left"></i>
          </span>
          <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next slider-arrow slider-arrow-right hero-control" type="button" data-bs-target="#heroPromoCarousel" data-bs-slide="next">
          <span class="slider-arrow-icon" aria-hidden="true">
            <i class="bi bi-chevron-right"></i>
          </span>
          <span class="visually-hidden">Next</span>
        </button>

        <div class="carousel-indicators hero-indicators mb-0">
          <button
            *ngFor="let slide of heroSlides; let i = index"
            type="button"
            data-bs-target="#heroPromoCarousel"
            [attr.data-bs-slide-to]="i"
            [class.active]="i === 0"
            [attr.aria-current]="i === 0 ? 'true' : null"
            [attr.aria-label]="slide.title"
          ></button>
        </div>
      </div>
    </section>
  </div>

  <div class="container home-content">
    <!-- Category Quick Links -->
    <section class="category-links-section section-spacer">
      <div class="d-flex flex-wrap justify-content-center gap-4 gap-md-5">
        <a *ngFor="let category of categoryLinks" [routerLink]="['/shop/products']" [queryParams]="{ category: category.name }" class="category-quick-link">
          <div class="category-thumbnail">
            <i class="bi" [ngClass]="category.icon"></i>
          </div>
          <span class="category-name">{{ category.name }}</span>
        </a>
      </div>
    </section>

    <!-- Trending Products -->
    <section class="trending-section section-spacer">
      <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between mb-3 mb-lg-4">
        <div>
          <p class="section-eyebrow mb-2">Popular Picks</p>
          <h2 class="h3 fw-bold mb-0">Trending Product</h2>
        </div>
        <a [routerLink]="['/shop/products']" [queryParams]="{ sort: 'newest' }" class="btn btn-link px-0 text-success fw-semibold text-decoration-none mt-2 mt-md-0">
          View All
          <i class="bi bi-arrow-right-short ms-1" aria-hidden="true"></i>
        </a>
      </div>

      <div class="row g-4">
        <div class="col-12 col-md-6 col-lg-3" *ngFor="let product of trendingProducts">
          <article class="card product-card h-100">
            <div class="card-top">
              <span *ngIf="product.badge" class="product-badge"
                    [ngClass]="{'badge-sale': product.badge === 'Sale', 'badge-hot': product.badge === 'Hot'}">
                {{ product.badge }}
              </span>
              <button type="button" class="wishlist-btn" aria-label="Add to wishlist">
                <i class="bi bi-heart" aria-hidden="true"></i>
              </button>
              <div class="product-image-container">
                <img [src]="product.mainImage" [alt]="product.name" loading="lazy" />
              </div>
            </div>
            <div class="card-body d-flex flex-column pt-3">
              <p class="small text-uppercase text-muted fw-semibold mb-2">{{ product.category }}</p>
              <h3 class="h6 fw-bold mb-2 text-truncate">{{ product.name }}</h3>
              <div class="d-flex align-items-center mb-3">
                <div class="product-stars me-2" [attr.aria-label]="(product.rating || 4) + ' out of 5 stars'">
                  <i class="bi bi-star-fill" *ngFor="let star of [1,2,3,4,5]; let i = index" [class.text-warning]="i < (product.rating || 4)"></i>
                </div>
                <span class="small text-muted">({{ product.reviewCount || 0 }})</span>
              </div>
              <div class="d-flex align-items-center justify-content-between mt-auto">
                <div class="d-flex align-items-center gap-2">
                  <p class="h5 fw-bold mb-0 text-dark">৳{{ (product.discountedPrice || product.price) | number:'1.2-2' }}</p>
                  <p class="small text-muted text-decoration-line-through mb-0" *ngIf="product.discountedPrice">৳{{ product.price | number:'1.2-2' }}</p>
                </div>
                <button class="btn btn-sm shop-btn rounded-pill px-3" (click)="onAddToCart(product)">Shop Now</button>
              </div>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- New in Electronics -->
    <section class="electronics-section section-spacer">
      <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between mb-3 mb-lg-4">
        <div>
          <p class="section-eyebrow mb-2">Tech & Gadgets</p>
          <h2 class="h3 fw-bold mb-0">New in Electronics</h2>
        </div>
        <a [routerLink]="['/shop/products']" [queryParams]="{ category: 'Electronics' }" class="btn btn-link px-0 text-success fw-semibold text-decoration-none mt-2 mt-md-0">
          View All
          <i class="bi bi-arrow-right-short ms-1" aria-hidden="true"></i>
        </a>
      </div>

      <div class="row g-4">
        <div class="col-12 col-md-6 col-lg-3" *ngFor="let product of electronicsProducts">
          <article class="card product-card h-100">
            <div class="card-top">
              <span *ngIf="product.badge" class="product-badge"
                    [ngClass]="{'badge-sale': product.badge === 'Sale', 'badge-hot': product.badge === 'Hot'}">
                {{ product.badge }}
              </span>
              <button type="button" class="wishlist-btn" aria-label="Add to wishlist">
                <i class="bi bi-heart" aria-hidden="true"></i>
              </button>
              <div class="product-image-container">
                <img [src]="product.mainImage" [alt]="product.name" loading="lazy" />
              </div>
            </div>
            <div class="card-body d-flex flex-column pt-3">
              <p class="small text-uppercase text-muted fw-semibold mb-2">{{ product.category }}</p>
              <h3 class="h6 fw-bold mb-2 text-truncate">{{ product.name }}</h3>
              <div class="d-flex align-items-center mb-3">
                <div class="product-stars me-2" [attr.aria-label]="(product.rating || 4) + ' out of 5 stars'">
                  <i class="bi bi-star-fill" *ngFor="let star of [1,2,3,4,5]; let i = index" [class.text-warning]="i < (product.rating || 4)"></i>
                </div>
                <span class="small text-muted">({{ product.reviewCount || 0 }})</span>
              </div>
              <div class="mt-auto">
                <div class="d-flex align-items-center gap-2 mb-3">
                  <p class="h5 fw-bold mb-0 text-dark">৳{{ (product.discountedPrice || product.price) | number:'1.2-2' }}</p>
                  <p class="small text-muted text-decoration-line-through mb-0" *ngIf="product.discountedPrice">৳{{ product.price | number:'1.2-2' }}</p>
                </div>
                <button class="btn btn-sm add-cart-btn rounded-pill py-2" (click)="onAddToCart(product)">Add to Cart</button>
              </div>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- Limited Deal Section -->
    <section class="limited-deal-section section-spacer">
      <article class="limited-deal-card rounded-4 p-3 p-md-4 p-xl-5 overflow-hidden">
        <div class="row g-4 g-xl-5 align-items-center">
          <div class="col-12 col-lg-5">
            <a [attr.href]="limitedDeal.ctaLink" class="limited-deal-media d-block text-decoration-none">
              <img class="limited-deal-image img-fluid" [src]="limitedDeal.imageUrl" [alt]="limitedDeal.imageAlt" loading="lazy" />
            </a>
          </div>

          <div class="col-12 col-lg-7">
            <div class="d-flex flex-wrap align-items-center gap-2 mb-3">
              <span class="badge badge-sale">Flash Sale</span>
              <p class="small text-uppercase limited-deal-muted fw-semibold mb-0">Limited-Time Deal</p>
            </div>

            <h2 class="limited-deal-title text-white fw-bold fst-italic mb-3">{{ limitedDeal.title }}</h2>
            <p class="limited-deal-copy mb-4">{{ limitedDeal.subtitle }}</p>

            <div class="d-flex flex-wrap align-items-end gap-3 gap-md-4 mb-4">
              <div>
                <p class="small text-uppercase limited-deal-muted fw-semibold mb-1">Deal Price</p>
                <p class="limited-deal-price mb-0">৳{{ limitedDeal.dealPrice | number: '1.2-2' }}</p>
              </div>
              <div>
                <p class="small text-uppercase limited-deal-muted fw-semibold mb-1">Original Price</p>
                <p class="limited-deal-original mb-0">৳{{ limitedDeal.originalPrice | number: '1.2-2' }}</p>
              </div>
            </div>

            <div class="limited-countdown mb-4" role="timer" aria-live="polite" aria-label="Deal countdown timer">
              <div class="countdown-box">
                <span class="countdown-value">{{ countdown.days }}</span>
                <span class="countdown-label">Days</span>
              </div>
              <div class="countdown-box">
                <span class="countdown-value">{{ countdown.hours }}</span>
                <span class="countdown-label">Hours</span>
              </div>
              <div class="countdown-box">
                <span class="countdown-value">{{ countdown.minutes }}</span>
                <span class="countdown-label">Minutes</span>
              </div>
              <div class="countdown-box">
                <span class="countdown-value">{{ countdown.seconds }}</span>
                <span class="countdown-label">Seconds</span>
              </div>
            </div>

            <div class="limited-stock mb-4">
              <div class="d-flex flex-wrap justify-content-between gap-2 align-items-center mb-2">
                <p class="small limited-deal-muted fw-semibold mb-0">{{ limitedDeal.claimedPercent }}% claimed</p>
                <p class="small limited-deal-muted fw-semibold mb-0">{{ limitedDeal.claimedUnits }} of {{ limitedDeal.totalUnits }} items claimed</p>
              </div>
              <div class="progress limited-progress" role="progressbar" [attr.aria-valuenow]="limitedDeal.claimedPercent" aria-valuemin="0" aria-valuemax="100" aria-label="Deal stock claimed">
                <div class="progress-bar limited-progress-bar" [style.width.%]="limitedDeal.claimedPercent"></div>
              </div>
            </div>

            <button class="btn btn-success btn-lg rounded-pill px-4 fw-semibold limited-deal-cta" *ngIf="limitedDeal.product" (click)="onAddToCart(limitedDeal.product!)">
              <i class="bi bi-lightning-fill me-2" aria-hidden="true"></i>
              Grab This Deal
            </button>
          </div>
        </div>
      </article>
    </section>

    <!-- Fashion Essentials -->
    <section class="fashion-section section-spacer">
      <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between mb-3 mb-lg-4">
        <div>
          <p class="section-eyebrow mb-2">Style Edit</p>
          <h2 class="h3 fw-bold mb-0">Fashion Essentials</h2>
        </div>
        <a [routerLink]="['/shop/products']" [queryParams]="{ category: 'Fashion' }" class="btn btn-link px-0 text-success fw-semibold text-decoration-none mt-2 mt-md-0">
          View All
          <i class="bi bi-arrow-right-short ms-1" aria-hidden="true"></i>
        </a>
      </div>

      <div class="row g-4">
        <div class="col-12 col-md-6 col-lg-3" *ngFor="let product of fashionProducts">
          <article class="card product-card h-100">
            <div class="card-top">
              <span *ngIf="product.badge" class="product-badge"
                    [ngClass]="{'badge-sale': product.badge === 'Sale', 'badge-hot': product.badge === 'Hot'}">
                {{ product.badge }}
              </span>
              <button type="button" class="wishlist-btn" aria-label="Add to wishlist">
                <i class="bi bi-heart" aria-hidden="true"></i>
              </button>
              <div class="product-image-container">
                <img [src]="product.mainImage" [alt]="product.name" loading="lazy" />
              </div>
            </div>
            <div class="card-body d-flex flex-column pt-3">
              <p class="small text-uppercase text-muted fw-semibold mb-2">{{ product.category }}</p>
              <h3 class="h6 fw-bold mb-2 text-truncate">{{ product.name }}</h3>
              <div class="d-flex align-items-center mb-3">
                <div class="product-stars me-2" [attr.aria-label]="(product.rating || 4) + ' out of 5 stars'">
                  <i class="bi bi-star-fill" *ngFor="let star of [1,2,3,4,5]; let i = index" [class.text-warning]="i < (product.rating || 4)"></i>
                </div>
                <span class="small text-muted">({{ product.reviewCount || 0 }})</span>
              </div>
              <div class="mt-auto">
                <div class="d-flex align-items-center gap-2 mb-3">
                  <p class="h5 fw-bold mb-0 text-dark">৳{{ (product.discountedPrice || product.price) | number:'1.2-2' }}</p>
                  <p class="small text-muted text-decoration-line-through mb-0" *ngIf="product.discountedPrice">৳{{ product.price | number:'1.2-2' }}</p>
                </div>
                <button class="btn btn-sm add-cart-btn rounded-pill py-2" (click)="onAddToCart(product)">Add to Cart</button>
              </div>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- Best Selling Products -->
    <section class="best-selling-section section-spacer">
      <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between mb-3 mb-lg-4">
        <div>
          <p class="section-eyebrow mb-2">Top Picks</p>
          <h2 class="h3 fw-bold mb-0">Best Selling Product</h2>
        </div>
        <a [routerLink]="['/shop/products']" [queryParams]="{ sort: 'bestSelling' }" class="btn btn-link px-0 text-success fw-semibold text-decoration-none mt-2 mt-md-0">
          View All
          <i class="bi bi-arrow-right-short ms-1" aria-hidden="true"></i>
        </a>
      </div>

      <div class="row g-4">
        <div class="col-12 col-md-6 col-lg-3" *ngFor="let product of bestSellingProducts">
          <article class="card product-card h-100">
            <div class="card-top">
              <span *ngIf="product.badge" class="product-badge"
                    [ngClass]="{'badge-sale': product.badge === 'Sale', 'badge-hot': product.badge === 'Hot'}">
                {{ product.badge }}
              </span>
              <button type="button" class="wishlist-btn" aria-label="Add to wishlist">
                <i class="bi bi-heart" aria-hidden="true"></i>
              </button>
              <div class="product-image-container">
                <img [src]="product.mainImage" [alt]="product.name" loading="lazy" />
              </div>
            </div>
            <div class="card-body d-flex flex-column pt-3">
              <p class="small text-uppercase text-muted fw-semibold mb-2">{{ product.category }}</p>
              <h3 class="h6 fw-bold mb-2 text-truncate">{{ product.name }}</h3>
              <div class="d-flex align-items-center mb-3">
                <div class="product-stars me-2" [attr.aria-label]="(product.rating || 4) + ' out of 5 stars'">
                  <i class="bi bi-star-fill" *ngFor="let star of [1,2,3,4,5]; let i = index" [class.text-warning]="i < (product.rating || 4)"></i>
                </div>
                <span class="small text-muted">({{ product.reviewCount || 0 }})</span>
              </div>
              <div class="d-flex align-items-center justify-content-between mt-auto">
                <div class="d-flex align-items-center gap-2">
                  <p class="h5 fw-bold mb-0 text-dark">৳{{ (product.discountedPrice || product.price) | number:'1.2-2' }}</p>
                  <p class="small text-muted text-decoration-line-through mb-0" *ngIf="product.discountedPrice">৳{{ product.price | number:'1.2-2' }}</p>
                </div>
                <a href="#" class="btn btn-sm shop-btn rounded-pill px-3" (click)="onAddToCart(product)">Shop Now</a>
              </div>
            </div>
          </article>
        </div>
      </div>
    </section>

    <!-- Happy Customers -->
    <section class="happy-customers-section section-spacer">
      <div class="happy-customers-panel rounded-4 p-3 p-md-4 p-xl-5">
        <header class="text-center mb-4 mb-lg-5">
          <p class="section-eyebrow mb-2">What They Say</p>
          <h2 class="h2 fw-bold mb-0">Our Happy Customers</h2>
        </header>

        <div id="happyCustomersCarousel" class="carousel slide carousel-dark happy-customers-carousel" data-bs-ride="carousel" data-bs-touch="true" data-bs-interval="5600">
          <div class="carousel-inner">
            <div class="carousel-item active">
              <div class="row g-4">
                <div class="col-12 col-md-6 col-lg-4">
                  <article class="card border-0 testimonial-card h-100 p-4">
                    <div class="d-flex align-items-center mb-3">
                      <img class="testimonial-avatar rounded-circle me-3" src="https://i.pravatar.cc/120?img=32" alt="Ayesha Rahman" loading="lazy" />
                      <div>
                        <h3 class="h6 fw-bold mb-1">Ayesha Rahman</h3>
                        <div class="testimonial-stars" aria-label="5 out of 5 stars">
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                        </div>
                      </div>
                    </div>
                    <p class="testimonial-text mb-0">Cartify made checkout effortless. The product quality exceeded my expectation and shipping was lightning fast.</p>
                  </article>
                </div>

                <div class="col-12 col-md-6 col-lg-4">
                  <article class="card border-0 testimonial-card h-100 p-4">
                    <div class="d-flex align-items-center mb-3">
                      <img class="testimonial-avatar rounded-circle me-3" src="https://i.pravatar.cc/120?img=14" alt="Nafis Chowdhury" loading="lazy" />
                      <div>
                        <h3 class="h6 fw-bold mb-1">Nafis Chowdhury</h3>
                        <div class="testimonial-stars" aria-label="5 out of 5 stars">
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                        </div>
                      </div>
                    </div>
                    <p class="testimonial-text mb-0">Best deals I have seen in one place. I upgraded my gaming setup and saved a lot during their flash promotions.</p>
                  </article>
                </div>

                <div class="col-12 col-md-6 col-lg-4">
                  <article class="card border-0 testimonial-card h-100 p-4">
                    <div class="d-flex align-items-center mb-3">
                      <img class="testimonial-avatar rounded-circle me-3" src="https://i.pravatar.cc/120?img=5" alt="Sadia Karim" loading="lazy" />
                      <div>
                        <h3 class="h6 fw-bold mb-1">Sadia Karim</h3>
                        <div class="testimonial-stars" aria-label="5 out of 5 stars">
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                        </div>
                      </div>
                    </div>
                    <p class="testimonial-text mb-0">The collections feel premium and curated. I found exactly what I needed for work and weekend looks.</p>
                  </article>
                </div>
              </div>
            </div>

            <div class="carousel-item">
              <div class="row g-4">
                <div class="col-12 col-md-6 col-lg-4">
                  <article class="card border-0 testimonial-card h-100 p-4">
                    <div class="d-flex align-items-center mb-3">
                      <img class="testimonial-avatar rounded-circle me-3" src="https://i.pravatar.cc/120?img=44" alt="Rafiul Hasan" loading="lazy" />
                      <div>
                        <h3 class="h6 fw-bold mb-1">Rafiul Hasan</h3>
                        <div class="testimonial-stars" aria-label="5 out of 5 stars">
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                        </div>
                      </div>
                    </div>
                    <p class="testimonial-text mb-0">Customer support was excellent and responsive. They helped me track my order within minutes.</p>
                  </article>
                </div>

                <div class="col-12 col-md-6 col-lg-4">
                  <article class="card border-0 testimonial-card h-100 p-4">
                    <div class="d-flex align-items-center mb-3">
                      <img class="testimonial-avatar rounded-circle me-3" src="https://i.pravatar.cc/120?img=47" alt="Maliha Tasnim" loading="lazy" />
                      <div>
                        <h3 class="h6 fw-bold mb-1">Maliha Tasnim</h3>
                        <div class="testimonial-stars" aria-label="5 out of 5 stars">
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                        </div>
                      </div>
                    </div>
                    <p class="testimonial-text mb-0">I love how smooth the mobile experience is. Browsing, filtering, and checkout all feel super fast.</p>
                  </article>
                </div>

                <div class="col-12 col-md-6 col-lg-4">
                  <article class="card border-0 testimonial-card h-100 p-4">
                    <div class="d-flex align-items-center mb-3">
                      <img class="testimonial-avatar rounded-circle me-3" src="https://i.pravatar.cc/120?img=57" alt="Tanvir Alam" loading="lazy" />
                      <div>
                        <h3 class="h6 fw-bold mb-1">Tanvir Alam</h3>
                        <div class="testimonial-stars" aria-label="5 out of 5 stars">
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                        </div>
                      </div>
                    </div>
                    <p class="testimonial-text mb-0">Cartify is now my first stop before buying anything online. Great quality, fair prices, and reliable delivery.</p>
                  </article>
                </div>
              </div>
            </div>
          </div>

          <div class="carousel-indicators explore-indicators testimonials-indicators mb-0">
            <button type="button" data-bs-target="#happyCustomersCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Customer testimonials page 1"></button>
            <button type="button" data-bs-target="#happyCustomersCarousel" data-bs-slide-to="1" aria-label="Customer testimonials page 2"></button>
          </div>
        </div>

        <div class="text-center mt-4 mt-lg-5">
          <a href="#" class="btn btn-success btn-lg rounded-pill px-5 py-3 fw-bold happy-customers-cta">GET STARTED</a>
        </div>
      </div>
    </section>
  </div>

  <!-- Toast Notification -->
  <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 1100;">
    <div class="toast align-items-center text-white bg-success border-0" [class.show]="showToast" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body fw-semibold">
          <i class="bi bi-check-circle-fill me-2"></i>
          {{ toastMessage }}
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" (click)="showToast = false" aria-label="Close"></button>
      </div>
    </div>
  </div>
</section>
